I have analyzed the issue and identified that the error `Unexpected token '<'` is caused by the backend returning an HTML response (likely a login page redirect or an error page) instead of the expected JSON when the "Post Listing" button is clicked. This typically happens when the request is not authenticated or encounters a server error, but the client does not explicitly request a JSON response.

Here is the plan to fix this:

1.  **Frontend Fix (`frontend_dashboard_add_listing.blade.php`)**:
    *   Update the `submitForm` function to include the `Accept: application/json` header in the `fetch` request. This tells Laravel to return JSON errors instead of HTML pages.
    *   Enhance the JavaScript error handling to check `response.ok` and the `Content-Type` header before parsing JSON. This will prevent the "Unexpected token <" crash and allow us to show a user-friendly error message (e.g., "Session expired" or "Server Error").
    *   Add logic to handle `401 Unauthorized` or `419 Page Expired` (CSRF) errors by prompting the user to reload.

2.  **Backend Fix (`app/Http/Middleware/TelegramWebAppAuth.php`)**:
    *   Modify the authentication middleware to check if the request expects JSON (`$request->expectsJson()`).
    *   If the user is not authenticated and it's a JSON request, return a `401 Unauthorized` JSON response instead of redirecting to the HTML login page (`/webapp`). This prevents the frontend from receiving unexpected HTML.

3.  **Validation & Logging**:
    *   Verify that the Controller (`TelegramWebAppController.php`) correctly validates inputs and logs errors (it already has a try-catch block with logging, but I will ensure the validation logic is robust).
    *   The frontend validation in Step 1, 2, 3 seems comprehensive, but I will double-check that all required fields are validated before submission.

4.  **Verification**:
    *   After applying the fixes, I will simulate the submission process to ensure it works correctly or displays a clear error message if something goes wrong.

This plan addresses all points in your request: fixing the crash, verifying logic, ensuring validation, and adding error logging.
